<!doctype html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apresenta√ß√£o Black Box - Projeto Web</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reset.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/theme/white.min.css" id="theme">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/arduino-light.min.css">

    <style>
        .reveal h1, .reveal h2, .reveal h3 { text-transform: none; }
        .reveal pre { box-shadow: 0 0 10px rgba(0,0,0,0.1); width: 100%; }
        .reveal code { font-size: 0.8em; line-height: 1.2em; max-height: 500px; }
        .two-columns { display: flex; justify-content: space-between; gap: 20px; }
        .col { flex: 1; }
        .highlight { color: #2563eb; font-weight: bold; }
        .feature-icon { font-size: 2em; margin-bottom: 10px; }
        iframe { width: 100%; height: 500px; border: 1px solid #ccc; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
<div class="reveal">
    <div class="slides">

        <section>
            <h1>Black Box: Bot & 1v1</h1>
            <h3>Projeto de Desenvolvimento Web</h3>
            <p>
                <small>Desenvolvido com MERN Stack + Vite + WebRTC</small>
            </p>
            <p style="margin-top: 20px; font-size: 0.6em; color: #666;">
                Navegue usando as setas do teclado ‚û°
            </p>
        </section>

        <section>
            <h2>Sum√°rio</h2>
            <ul>
                <li>Vis√£o Geral do Projeto (Usu√°rio)</li>
                <li>Arquitetura e Tecnologias (Dev)</li>
                <li>Frontend: L√≥gica do Jogo e React</li>
                <li>Backend: API, Auth e Banco de Dados</li>
                <li>Funcionalidades Avan√ßadas (V√≠deo e Sockets)</li>
                <li>Seguran√ßa</li>
                <li>Demonstra√ß√£o Pr√°tica</li>
            </ul>
        </section>

        <section>
            <h2>O que √© o Black Box?</h2>
            <div class="two-columns">
                <div class="col" style="font-size: 0.8em; text-align: left;">
                    <p>Um jogo de l√≥gica e dedu√ß√£o baseado em "raios" e "√°tomos" escondidos em um tabuleiro 8x8.</p>
                    <ul>
                        <li><strong>Modo Bot:</strong> Jogue sozinho contra o computador (gera√ß√£o aleat√≥ria).</li>
                        <li><strong>Modo 1v1:</strong> Jogue localmente (pass-and-play) com contagem de score.</li>
                        <li><strong>Ranking:</strong> Tabela global de melhores pontua√ß√µes.</li>
                        <li><strong>Replay:</strong> Grava√ß√£o da partida em v√≠deo.</li>
                    </ul>
                </div>
                <div class="col">
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 2px; width: 200px; margin: auto;">
                        <div style="background:#ddd; height:40px;"></div><div style="background:#ddd; height:40px;"></div><div style="background:#ddd; height:40px;"></div><div style="background:#ddd; height:40px;"></div>
                        <div style="background:#ddd; height:40px;"></div><div style="background:#2563eb; height:40px;"></div><div style="background:#ddd; height:40px;"></div><div style="background:#ddd; height:40px;"></div>
                        <div style="background:#ddd; height:40px;"></div><div style="background:#ddd; height:40px;"></div><div style="background:#ddd; height:40px;"></div><div style="background:#ddd; height:40px;"></div>
                    </div>
                    <p style="font-size: 0.6em;">Conceito: Disparar raios para triangular posi√ß√µes.</p>
                </div>
            </div>
        </section>

        <section>
            <h2>Arquitetura Tecnol√≥gica</h2>
            <p>Stack <strong>MERN</strong> (Mongo, Express, React, Node)</p>
            <div style="font-size: 0.8em; text-align: left;">
                <ul>
                    <li><strong>Frontend:</strong> React (Vite), CSS Modules.</li>
                    <li><strong>Backend:</strong> Node.js com Express.</li>
                    <li><strong>Database:</strong> MongoDB (Mongoose) + GridFS (V√≠deos).</li>
                    <li><strong>Realtime:</strong> Socket.io (Chat e Matchmaking).</li>
                    <li><strong>Media:</strong> WebRTC (Display Media) para grava√ß√£o.</li>
                </ul>
            </div>
            <div style="margin-top: 20px; font-size: 0.7em; background: #f0f0f0; padding: 10px; border-radius: 8px;">
                <code>Client (Port 5173) ‚¨ÖÔ∏è Proxy ‚û°Ô∏è Server (Port 4000) ‚¨ÖÔ∏è MongoDB</code>
            </div>
        </section>

        <section>
            <h2>Frontend: A L√≥gica dos Raios</h2>
            <p style="font-size: 0.6em;">Arquivo: <code>client/src/components/GameBoard.jsx</code></p>
            <pre><code class="language-javascript" data-trim data-line-numbers="1-15">
// L√≥gica de simula√ß√£o de raios no tabuleiro
function shootRay(atoms, entryIdx){
  let {r,c,dir} = entryFromEdgeIndex(entryIdx);
  // ... verifica√ß√£o de colis√£o inicial ...

  for(let steps=0; steps<1000; steps++){
    // Verifica colis√£o direta (HIT)
    if(hasAtom(atoms,tr,tc)) return { type:'HIT' };

    // Verifica deflex√£o (REFLECTION)
    const ld=inside(tr,tc-1) && hasAtom(atoms,tr,tc-1);
    const rd=inside(tr,tc+1) && hasAtom(atoms,tr,tc+1);

    // ... l√≥gica de mudan√ßa de dire√ß√£o ...
  }
  return { type:'EXIT', exit: edgeIndexFromExit(tr,tc) };
}
                </code></pre>
            <p style="font-size: 0.5em;">Utilizamos hooks (<code>useState</code>, <code>useMemo</code>) para gerenciar o estado do tabuleiro e placar.</p>
        </section>

        <section>
            <h2>Backend: Autentica√ß√£o Segura</h2>
            <p style="font-size: 0.6em;">Arquivo: <code>server/src/controllers/authController.js</code></p>
            <div style="font-size: 0.7em;">
                <ul>
                    <li>Uso de <strong>JWT (JSON Web Tokens)</strong>.</li>
                    <li>Armazenamento seguro em <strong>Cookies HTTP-Only</strong> (previne XSS).</li>
                    <li>Senha com Hash via <strong>Bcrypt</strong>.</li>
                </ul>
            </div>
            <pre><code class="language-javascript" data-trim data-line-numbers="5-12">
// Login controller
const ok = await bcrypt.compare(password, user.passwordHash);
if (!ok) return res.status(401).json({ error: 'Inv√°lido' });

const token = signToken(user._id);

res.cookie('bbx_token', token, {
  httpOnly: true, // Inacess√≠vel via JS no navegador
  sameSite: 'lax',
  secure: false, // Em prod seria true
}).json({ user: ... });
                </code></pre>
        </section>

        <section>
            <h2>Upload de V√≠deo (GridFS)</h2>
            <div class="two-columns">
                <div class="col" style="font-size: 0.7em;">
                    <p><strong>Frontend:</strong> Captura a tela com <code>navigator.mediaDevices.getDisplayMedia</code> e envia um Blob.</p>
                    <p><strong>Backend:</strong> Recebe via Multer e faz stream direto para o MongoDB usando <strong>GridFS</strong> (para arquivos grandes).</p>
                </div>
                <div class="col">
                        <pre><code class="language-javascript" style="font-size: 0.6em;" data-trim>
// server/src/routes/videoRoutes.js
const bucket = getVideoBucket();
const uploadStream = bucket.openUploadStream(filename);

uploadStream.on('finish', async () => {
    await Video.create({
        fileId: uploadStream.id,
        owner: req.userId
    });
    // ...
});

uploadStream.end(req.file.buffer);
                        </code></pre>
                </div>
            </div>
        </section>

        <section>
            <h2>Aspectos de Seguran√ßa</h2>
            <ul>
                <li><strong>Helmet:</strong> Middleware para proteger headers HTTP.</li>
                <li><strong>CORS:</strong> Configurado para aceitar apenas a origem do cliente (`http://localhost:5173`).</li>
                <li><strong>Input Validation:</strong> Verifica√ß√£o de tipos no backend antes de processar.</li>
                <li><strong>Autentica√ß√£o:</strong> Prote√ß√£o de rotas com middleware <code>requireAuth</code>.</li>
            </ul>
            <pre><code class="language-javascript" data-trim>
// server/src/middleware/auth.js
export function requireAuth(req, res, next) {
  const token = req.cookies?.bbx_token;
  if (!token) return res.status(401).json(...);
  // Verifica√ß√£o do token JWT...
}
                </code></pre>
        </section>

        <section>
            <h2>Demonstra√ß√£o Pr√°tica</h2>
            <p style="font-size: 0.7em;">
                O sistema est√° rodando localmente. Abaixo, a interface de Login/Jogo.
            </p>
            <iframe src="https://web.lucas.barao.vms.ufsc.br/" title="Demonstra√ß√£o Black Box"></iframe>
            <p style="font-size: 0.5em; margin-top: 10px;">
                <a href="https://web.lucas.barao.vms.ufsc.br/" target="_blank">Abrir em nova aba üîó</a>
            </p>
        </section>

        <section>
            <h2>Modelagem de Dados</h2>
            <div class="two-columns" style="font-size: 0.7em;">
                <div class="col">
                    <h4>User</h4>
                    <ul>
                        <li>Nickname (Unique)</li>
                        <li>PasswordHash</li>
                        <li>AvatarUrl</li>
                        <li>Dados demogr√°ficos</li>
                    </ul>
                </div>
                <div class="col">
                    <h4>Game</h4>
                    <ul>
                        <li>Player (Ref User)</li>
                        <li>Mode ('bot' | 'pvp')</li>
                        <li>Score (Menor √© melhor)</li>
                        <li>Video (Ref Video)</li>
                    </ul>
                </div>
            </div>
        </section>

        <section>
            <h2>Conclus√£o</h2>
            <ul>
                <li>Projeto funcional integrando diversas tecnologias modernas.</li>
                <li>Foco em UX (Avatar, Drag & Drop, Feedback visual).</li>
                <li>Foco em Performance (Streams de v√≠deo, WebSockets).</li>
            </ul>
            <h3 style="margin-top: 40px;">D√∫vidas?</h3>
        </section>

    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/plugin/highlight/highlight.min.js"></script>
<script>
    Reveal.initialize({
        hash: true,
        // Configura√ß√£o para n√£o usar tema escuro e facilitar leitura
        center: true,
        slideNumber: true,
        plugins: [ RevealHighlight ]
    });
</script>
</body>
</html>